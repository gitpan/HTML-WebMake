<?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
 <title>
WebMake: Documentation: WebMake Operation
</title>
 <meta name="generator" content="WebMake/1.2" />
 <style>
body {
 background-color: #ffffff; 
 color: #000000; 
 font-size: medium;
 font-family: verdana,lucida,helvetica,sans-serif;
}
// OL,UL,P,BODY,TD,TR,TH,FORM {
 // font-family: verdana,lucida,helvetica,sans-serif;
 // font-size: medium;
 // color: #000000;
}
code, samp, pre
{
 font-family: monospace;
}
H1 { font-size: x-large; font-family: Garamond,Book Antiqua,Times,serif; background: #FFCC66; }
H2 { font-size: large; font-family: Garamond,Book Antiqua,Times,serif; background: #FFDD77; }
H3 { font-size: medium; font-family: Garamond,Book Antiqua,Times,serif; background: #FFEE88; }
H4 { font-size: small; font-family: Garamond,Book Antiqua,Times,serif; }
H5 { font-size: x-small; font-family: Garamond,Book Antiqua,Times,serif; }
H6 { font-size: xx-small; font-family: Garamond,Book Antiqua,Times,serif; }
A:link {
 font-weight: bold;
 color: #004000;
 text-decoration: underline; 
}
A:visited {
 font-weight: normal;
 color: #008000;
 text-decoration: underline; 
}
A:active {
 font-weight: bold;
 color: #800000;
 text-decoration: underline; 
}
</style>
 
</head>
 <body bgcolor="#ffffff" text="#000000" link="#3300cc" vlink="#660066">
 <font face="lucida,verdana,sans-serif">
 <div align="center">
 <img src="images/WebMakeTitle.png" width="500" height="122" />
</div>
 <table width="100%">
<tr>
<td valign="top">
 <strong><a href="http://webmake.taint.org/">WebMake</a>
 Documentation</strong> (version 1.2)
 
</td>
<td valign="top">
 <div align="right">

 [ <a href="cms.html">Back</a> | <a href="invoking.html">Forward</a> | <a href="index.html">Index</a>
 | <a href="allinone.html">All&nbsp;In&nbsp;One</a> ]
 
</div>
 
</td>
</tr>
</table>
   <table border="0" cellpadding="0" cellspacing="0" width="100%">
 <tr>
<td bgcolor="#aaaaaa">
 <table border="0" cellspacing="4" cellpadding="4" width="100%">
 <tr>
<td bgcolor="#ffffff">
 <table border="0" cellspacing="4" cellpadding="4" width="100%">
 <tr>
<td>
 <h1>WebMake Operation</h1><p>
When you run WebMake, it'll first search for a file ending with <strong>.wmk</strong> in
the current directory, then in the parent directory, and so on 'til it hits
the root directory.

</p>
 <p>
Alternatively if you use the <strong>-R</strong> switch, it'll search relative to the
filename specified on the command-line; this is <em>very</em> handy if you're
calling WebMake from a macro in your editor or IDE, as it means you don't even
have to be running the editor in the same working directory as the files
you're working on.

</p>
 <p>
Anyway, once it finds the WebMake file, it reads the file and parses it.
<strong>Contents</strong> and <strong>media</strong> statements will cause it to search directories or
other data sources for content (directly includable files and text blocks) or
media (static content that can be linked to or otherwise referred to with a
href). <strong>Include</strong> statements will cause it to directly include a block of
code from another file.

</p>
 <p>
Finally, once the WebMake file has been parsed, the list of <strong>out</strong>
files will have been read. Each of these is roughly equivalent to
a <em>target</em> in traditional UNIX <em>make(1)</em> terminology.

</p>
 <p>
If a target has been specified on the command line, that file will be made;
otherwise, all the <strong>out</strong> files named in the WebMake file will be made.

</p>
 <a name="Dependencies_And_Other_Optimisations"><h1>Dependencies And Other Optimisations</h1></a> <p>
"Making" the target is not the end of it -- strictly speaking, the target
may or may not be updated. WebMake tracks the dependencies of each file, and
if these have not changed, the file will not be rebuilt.

</p>
 <p>
That's the first optimisation. However it doesn't always work; if some of the
file's text is generated by, or depends on text that contains dynamic Perl
code, WebMake will always have to rebuild the file.

</p>
 <p>
To avoid continually "churning" the file, regenerating it every time WebMake
is run, a comparison step takes place. Before the file is written to disk,
WebMake compares the file in memory with the file on disk; if there are no
changes, the on-disk file will not be modified in any way. This means tools
like <em>rsync(1)</em>, <em>rdist(1)</em> or even <em>make(1)</em> itself will work fine with
a WebMake site.

</p>
 <p>
All of these optimisations can be overridden by using the <strong>-F</strong> (freshen)
command-line switch; this will force output whether or not the files have
changed.

</p>
 <a name="Ensuring_A_Seamless_Transition"><h1>Ensuring A Seamless Transition</h1></a> <p>
A very large (or very complicated) WebMake site can take a while to update.
To avoid broken links while updating the site, WebMake generates all output
into temporary files called <strong><em>filename</em>.new</strong>; once all the output
has been generated, these are renamed into place. This minimises the
time during which there may be inconsistencies in the site.

</p>
 <a name="Caching"><h1>Caching</h1></a> <p>
Since WebMake uses dependencies to avoid rebuilding the entire site
every time, it needs to cache <a href="metadata.html">metadata</a> and dependency information
somewhere.

</p>
 <p>
Currently this data is stored in a file called <strong><em>filename</em>/cache.db</strong>,
where <em>filename</em> is a sanitised version of the WebMake file's name, in the
<strong>.webmake</strong> subdirectory of your home directory.

</p>
 <p>

</p>
</td>
</tr>
</table>
 
</td>
</tr>
</table>
 
</td>
</tr>
</table>
 <table width="100%">
<tr>
<td valign="top">
 <strong><a href="http://webmake.taint.org/">WebMake</a>
 Documentation</strong> (version 1.2)
 
</td>
<td valign="top">
 <div align="right">

 [ <a href="cms.html">Back</a> | <a href="invoking.html">Forward</a> | <a href="index.html">Index</a>
 | <a href="allinone.html">All&nbsp;In&nbsp;One</a> ]
 
</div>
 
</td>
</tr>
</table>
 <div align="right">
 <a href="http://webmake.taint.org/"> <img src="images/BuiltWithWebMake.png" border="0" width="88" height="31" /></a> 
</div>
 
</font>
</body>
</html>
